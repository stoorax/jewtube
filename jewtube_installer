# PowerShell-Skript zur Installation von JewTube + yewtube
echo "=== JewTube Installation ==="
$logFile = "C:\Users\$env:USERNAME\AppData\Local\Temp\JewTube_Install_$(Get-Date -Format 'yyyyMMdd_HHmmss').log"
Start-Transcript -Path $logFile -Append

# 1. Python-Prüfung
$pythonPath = (Get-Command python -ErrorAction SilentlyContinue).Source
if (-not $pythonPath) {
    Write-Error "Python nicht gefunden! Bitte installieren: https://www.python.org/downloads/"
    exit 1
}
echo "Python gefunden: $pythonPath"

# 2. Pip-Pakete installieren
$packages = @("yt-dlp", "ytmusicapi", "browser-cookie3", "yewtube")  # yewtube hinzugefügt
foreach ($pkg in $packages) {
    echo "Installiere $pkg..."
    pip install --upgrade $pkg
}

# 3. Versionsprüfung
echo "`n=== Versionsprüfung ==="
pip show yt-dlp ytmusicapi yewtube | Select-String "Version"

# 4. Funktionstest (yt-dlp)
echo "`n=== Funktionstest ==="
youtube-dl --version  # yt-dlp alias testen
yt-dlp -f b "https://www.youtube.com/watch?v=dQw4w9WgXcQ" --no-download  # Test ohne Download

# 5. yewtube-Konfiguration (falls benötigt)
echo "`n=== yewtube Setup ==="
yewtube --version
echo "Tipp: Starte yewtube mit 'yewtube' im Terminal."

echo "`n=== INSTALLATION ERFOLGREICH ==="
Stop-Transcript
echo "Logfile: $logFile"
Read-Host "Drücken Sie ENTER zum Beenden..."
